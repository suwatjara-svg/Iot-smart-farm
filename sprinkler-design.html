<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏õ‡∏£‡∏¥‡∏á‡πÄ‡∏Å‡∏≠‡∏£‡πå Smart Farm</title>

<style>
    body{
        font-family: "Sarabun","Segoe UI",Tahoma,sans-serif;
        background:#f4f6f8;
        margin:0;
        padding:0;
    }

    /* Floating Button */
    .floating-btn{
        position:fixed;
        top:80px;
        left:15px;
        background:#ff9800;
        color:white;
        padding:10px 16px;
        border-radius:30px;
        text-decoration:none;
        font-weight:bold;
        box-shadow:0 4px 10px rgba(0,0,0,0.3);
        z-index:999;
    }
    .floating-btn:hover{
        background:#f57c00;
    }

    .container{
        max-width:1000px;
        margin:auto;
        background:#fff;
        padding:20px;
        border-radius:12px;
        box-shadow:0 4px 12px rgba(0,0,0,0.1);
        margin-top:20px;
        margin-bottom:80px;
    }

    /* Header Image */
    .header-img{
        width:100%;
        border-radius:100px;
        margin-bottom:200px;
    }

    h1{
        text-align:center;
        color:#0d47a1;
    }
    h2{
        color:#0d47a1;
        border-left:6px solid #1976d2;
        padding-left:10px;
        margin-top:25px;
    }

    label{
        font-weight:bold;
    }
    input,select{
        width:100%;
        padding:8px;
        margin-top:4px;
        margin-bottom:10px;
        border-radius:6px;
        border:1px solid #ccc;
        box-sizing:border-box;
    }

    .row{
        display:flex;
        gap:15px;
    }
    .col{
        flex:1;
    }

    button{
        padding:10px 16px;
        border:none;
        border-radius:6px;
        cursor:pointer;
        font-size:16px;
    }
    #addZoneBtn{
        background:#4caf50;
        color:white;
        margin-top:10px;
    }
    #calcBtn{
        background:#0d47a1;
        color:white;
        width:100%;
        margin-top:15px;
    }

    /* Zone Card */
    .zone-card{
        border:1px solid #ddd;
        padding:10px;
        border-radius:8px;
        margin-top:10px;
        background:#fafafa;
    }

    /* Table */
    table{
        width:100%;
        border-collapse:collapse;
        margin-top:15px;
        font-size:14px;
    }
    th,td{
        border:1px solid #ccc;
        padding:6px 8px;
        text-align:center;
    }
    th{
        background:#e3f2fd;
    }
    tr:nth-child(even){
        background:#f9f9f9;
    }
    tr:hover{
        background:#e1f5fe;
    }

    .small{
        font-size:12px;
        color:#666;
    }

    /* Footer */
    footer {
    position: fixed;
    bottom: 0;
    left: 0;
    width: 100%;
    background: #0d47a1;
    color: white;
    padding: 10px 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
    gap: 10px;
    font-size: 14px;
    box-sizing: border-box;
}

footer span {
    flex: 1;
    min-width: 200px;
}

footer a {
    background: #4caf50;
    padding: 8px 14px;
    border-radius: 20px;
    color: white;
    text-decoration: none;
    font-weight: bold;
    white-space: nowrap;
}

footer a:hover {
    background: #43a047;
}

@media (max-width: 600px) {
    footer {
        flex-direction: column;
        text-align: center;
    }
    footer span, footer a {
        width: 100%;
        max-width: 100%;
    }
}
</style>
</head>

<body>

<!-- Floating Button -->
<a href="index.html" class="floating-btn">üè† ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</a>

<div class="container">

    <!-- Header Image -->
    <img src="rrigation-1866531_1280.jpg"
         alt="‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏õ‡∏£‡∏¥‡∏á‡πÄ‡∏Å‡∏≠‡∏£‡πå‡πÉ‡∏ô‡∏ü‡∏≤‡∏£‡πå‡∏°" class="header-img">

    <h1>‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏õ‡∏£‡∏¥‡∏á‡πÄ‡∏Å‡∏≠‡∏£‡πå Smart Farm</h1>

    <!-- Pump Info -->
    <h2>1) ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏±‡πä‡∏°‡∏ô‡πâ‡∏≥</h2>
    <div class="row">
        <div class="col">
            <label>‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡πÑ‡∏´‡∏•‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î‡∏Ç‡∏≠‡∏á‡∏õ‡∏±‡πä‡∏° (L/min)</label>
            <input type="number" id="pumpFlowMax" placeholder="‡πÄ‡∏ä‡πà‡∏ô 200">
        </div>
        <div class="col">
            <label>‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î‡∏Ç‡∏≠‡∏á‡∏õ‡∏±‡πä‡∏° (m)</label>
            <input type="number" id="pumpHeadMax" placeholder="‡πÄ‡∏ä‡πà‡∏ô 30">
        </div>
        <div class="col">
            <label>‡∏Ç‡∏ô‡∏≤‡∏î‡∏ó‡πà‡∏≠‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏õ‡∏±‡πä‡∏°</label>
            <select id="pumpPipeSize">
                <option value="0.5">1/2 ‡∏ô‡∏¥‡πâ‡∏ß</option>
                <option value="0.75">3/4 ‡∏ô‡∏¥‡πâ‡∏ß</option>
                <option value="1">1 ‡∏ô‡∏¥‡πâ‡∏ß</option>
                <option value="1.25">1 1/4 ‡∏ô‡∏¥‡πâ‡∏ß</option>
                <option value="1.5">1 1/2 ‡∏ô‡∏¥‡πâ‡∏ß</option>
                <option value="2">2 ‡∏ô‡∏¥‡πâ‡∏ß</option>
                <option value="2.5">2 1/2 ‡∏ô‡∏¥‡πâ‡∏ß</option>
                <option value="3">3 ‡∏ô‡∏¥‡πâ‡∏ß</option>
            </select>
        </div>
    </div>

    <label>‡πÄ‡∏ú‡∏∑‡πà‡∏≠ Margin ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ (%)</label>
    <select id="safetyMargin">
        <option value="0.10">10%</option>
        <option value="0.15">15%</option>
        <option value="0.20" selected>20%</option>
        <option value="0.25">25%</option>
        <option value="0.30">30%</option>
        <option value="0.40">40%</option>
    </select>

    <!-- Zones -->
    <h2>2) ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÇ‡∏ã‡∏ô‡∏™‡∏õ‡∏£‡∏¥‡∏á‡πÄ‡∏Å‡∏≠‡∏£‡πå</h2>
    <div id="zonesContainer"></div>
    <button id="addZoneBtn" onclick="addZone()">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏ã‡∏ô</button>

    <button id="calcBtn" onclick="calculate()">‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>

    <!-- Results -->
    <h2>3) ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå</h2>
    <div id="summary"></div>
    <div id="zoneTableContainer"></div>

    <p class="small">
        ‚úî Yes ‡∏´‡∏°‡∏≤‡∏¢‡∏ñ‡∏∂‡∏á‡∏õ‡∏±‡πä‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏à‡πà‡∏≤‡∏¢‡∏ô‡πâ‡∏≥‡πÅ‡∏•‡∏∞‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÇ‡∏ã‡∏ô‡∏ô‡∏±‡πâ‡∏ô  
        ‚ùå No ‡∏´‡∏°‡∏≤‡∏¢‡∏ñ‡∏∂‡∏á‡∏õ‡∏±‡πä‡∏°‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏à‡πà‡∏≤‡∏¢‡∏ô‡πâ‡∏≥‡∏´‡∏£‡∏∑‡∏≠‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡πÑ‡∏î‡πâ‡∏ï‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
    </p>

</div>

<!-- Footer -->
<footer>
    <span>‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏™‡∏õ‡∏£‡∏¥‡∏á‡πÄ‡∏Å‡∏≠‡∏£‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Smart Farm ‡πÇ‡∏î‡∏¢ ‡∏™‡∏∏‡∏ß‡∏±‡∏í‡∏ô‡πå ‡πÄ‡∏à‡∏£‡∏¥‡∏ç‡∏û‡∏¥‡∏ö‡∏π‡∏•‡∏¢‡πå</span>
    <a href="index.html">HOME</a>
</footer>

<script>
/* ========== JavaScript ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏õ‡∏£‡∏¥‡∏á‡πÄ‡∏Å‡∏≠‡∏£‡πå ========== */

const pipeDiameter = {
    0.5: 15, 0.75: 20, 1: 25, 1.25: 32,
    1.5: 40, 2: 50, 2.5: 63, 3: 75
};

const C_HW = 140;
let zoneIndex = 0;

function addZone(){
    zoneIndex++;
    const container = document.getElementById('zonesContainer');
    const div = document.createElement('div');
    div.className = 'zone-card';

    div.innerHTML = `
        <h3>‡πÇ‡∏ã‡∏ô‡∏ó‡∏µ‡πà ${zoneIndex}</h3>
        <div class="row">
            <div class="col">
                <label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏´‡∏±‡∏ß‡∏™‡∏õ‡∏£‡∏¥‡∏á‡πÄ‡∏Å‡∏≠‡∏£‡πå</label>
                <input type="number" id="heads_${zoneIndex}" placeholder="‡πÄ‡∏ä‡πà‡∏ô 5">
            </div>
            <div class="col">
                <label>‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡πÑ‡∏´‡∏•‡∏ï‡πà‡∏≠‡∏´‡∏±‡∏ß (L/h)</label>
                <input type="number" id="flowPerHead_${zoneIndex}" placeholder="‡πÄ‡∏ä‡πà‡∏ô 350">
            </div>
            <div class="col">
                <label>‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏´‡∏±‡∏ß‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ (bar)</label>
                <input type="number" id="pressureRequired_${zoneIndex}" placeholder="‡πÄ‡∏ä‡πà‡∏ô 1.5">
            </div>
        </div>

        <div class="row">
            <div class="col">
                <label>‡∏Ç‡∏ô‡∏≤‡∏î‡∏ó‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡πÇ‡∏ã‡∏ô</label>
                <select id="zonePipeSize_${zoneIndex}">
                    <option value="0.5">1/2 ‡∏ô‡∏¥‡πâ‡∏ß</option>
                    <option value="0.75">3/4 ‡∏ô‡∏¥‡πâ‡∏ß</option>
                    <option value="1">1 ‡∏ô‡∏¥‡πâ‡∏ß</option>
                    <option value="1.25">1 1/4 ‡∏ô‡∏¥‡πâ‡∏ß</option>
                    <option value="1.5">1 1/2 ‡∏ô‡∏¥‡πâ‡∏ß</option>
                </select>
            </div>
            <div class="col">
                <label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ç‡πâ‡∏≠‡∏á‡∏≠/‡∏ß‡∏≤‡∏•‡πå‡∏ß</label>
                <input type="number" id="fittings_${zoneIndex}" placeholder="‡πÄ‡∏ä‡πà‡∏ô 2">
            </div>
            <div class="col">
                <label>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡∏ó‡πà‡∏≠ (m)</label>
                <input type="number" id="pipeLength_${zoneIndex}" placeholder="‡πÄ‡∏ä‡πà‡∏ô 30">
            </div>
        </div>
    `;
    container.appendChild(div);
}

function hazenWilliams(Q, d, L){
    return 10.67 * L * Math.pow(Q,1.852) /
           (Math.pow(C_HW,1.852) * Math.pow(d,4.87));
}

function minorLoss(v, fittings){
    const g = 9.81;
    return fittings * 0.5 * v*v / (2*g);
}

function calculate(){
    const pumpFlowMax = parseFloat(document.getElementById('pumpFlowMax').value);
    const pumpHeadMax = parseFloat(document.getElementById('pumpHeadMax').value);
    const safetyMargin = parseFloat(document.getElementById('safetyMargin').value);

    let zones = [];
    let totalFlow = 0;

    for(let i=1;i<=zoneIndex;i++){
        const heads = parseFloat(document.getElementById(`heads_${i}`).value);
        const flowPerHead = parseFloat(document.getElementById(`flowPerHead_${i}`).value);
        const pressureRequired = parseFloat(document.getElementById(`pressureRequired_${i}`).value);
        const pipeSize = parseFloat(document.getElementById(`zonePipeSize_${i}`).value);
        const fittings = parseFloat(document.getElementById(`fittings_${i}`).value);
        const pipeLength = parseFloat(document.getElementById(`pipeLength_${i}`).value);

        const Q_Lmin = (heads * flowPerHead) / 60;
        totalFlow += Q_Lmin;

        const Q_m3s = Q_Lmin / 1000 / 60;
        const D_m = pipeDiameter[pipeSize] / 1000;
        const area = Math.PI * Math.pow(D_m/2,2);
        const v = Q_m3s / area;

        const hf_pipe = hazenWilliams(Q_m3s, D_m, pipeLength);
        const hf_minor = minorLoss(v, fittings);
        const hf_total = (hf_pipe + hf_minor) * (1 + safetyMargin);

        const headAtSprinkler = pumpHeadMax - hf_total;
        const pressureBar = headAtSprinkler / 10;

        const pumpOk = (pumpFlowMax >= Q_Lmin) && (pressureBar >= pressureRequired);

        zones.push({
            zone:i,
            Q_Lmin,
            hf_pipe,
            hf_total,
            pressureBar,
            pumpOk
        });
    }

    document.getElementById("summary").innerHTML = `
        <p><b>‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡πÑ‡∏´‡∏•‡∏£‡∏ß‡∏°‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡∏ó‡∏∏‡∏Å‡πÇ‡∏ã‡∏ô:</b> ${totalFlow.toFixed(2)} L/min</p>
        <p><b>‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î‡∏Ç‡∏≠‡∏á‡∏õ‡∏±‡πä‡∏°:</b> ${pumpHeadMax} m</p>
    `;

    let html = `
        <table>
            <tr>
                <th>‡πÇ‡∏ã‡∏ô</th>
                <th>‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡πÑ‡∏´‡∏• (L/min)</th>
                <th>Head loss (m)</th>
                <th>Head loss ‡∏£‡∏ß‡∏° + Margin (m)</th>
                <th>‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏´‡∏±‡∏ß (bar)</th>
                <th>‡∏õ‡∏±‡πä‡∏°‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà</th>
            </tr>
    `;

    zones.forEach(z=>{
        html += `
            <tr>
                <td>${z.zone}</td>
                <td>${z.Q_Lmin.toFixed(2)}</td>
                <td>${z.hf_pipe.toFixed(2)}</td>
                <td>${z.hf_total.toFixed(2)}</td>
                <td>${z.pressureBar.toFixed(2)}</td>
                <td>${z.pumpOk ? "‚úî Yes" : "‚ùå No"}</td>
            </tr>
        `;
    });

    html += `</table>`;
    document.getElementById("zoneTableContainer").innerHTML = html;
}
</script>

</body>
</html>